import"./leaflet-svg-shape-markers-8f7f1e58.js";import"./leaflet.rotatedMarker-71d1d069.js";import"./_commonjsHelpers-28e086c5.js";const n=window.burl,p=$("input[name=_deviceid]").val();var v=$("#tblmlfflist").DataTable({lengthChange:!1,order:[[1,"desc"]],scrollX:!0,columnDefs:[{visible:!1,targets:[0]},{targets:-1,defaultContent:'<button class="btnview btn btn-pure btn-primary icon md-view waves-effect waves-classic">Log</button>'}]}),g=null;$("#tblmlfflist tbody").on("click","button.btnview",function(){var i=v.row($(this).parents("tr")).data();g=i[0],$("#modallog").modal("show")});$.get(n+`/tracking/detail/js/mlff/${p}`,function(i){$.each(i.mlffHistoryData.data,function(r,t){var o="-",l="-",e="-";t.fddeclaration_exit&&(o=window.dtHumanParse(t.fddeclaration_exit),l=t.gate_exit_name,e=t.gate_exit_ftsection),v.row.add([t.id,window.dtHumanParse(t.fddeclaration),t.gate_name,t.ftsection,o,l,e,t.declaration_status]).draw(!0)})});var a,d,m=new L.featureGroup([]),s,c;$("#modallog").on("shown.bs.modal",function(){if(!a){a=L.map("trackingmlff_log",{minZoom:5,fullscreenControl:!0,attributionControl:!1}).setView([.33995192349439596,120.3733680354565],5);var i=L.tileLayer(window.mapLayer);i.addTo(a)}$.get(n+`/tracking/detail/js/mlff/log/${g}`,function(r){var t=r.data.data;r.data.routes&&_(t,r.data.routes)})});$("#modallog").on("hidden.bs.modal",function(){a.removeLayer(d),s&&a.removeLayer(s),c&&a.removeLayer(c)});function _(i,r){var t={type:"FeatureCollection",name:"line_relay",features:[{type:"Feature",properties:i,geometry:{type:"LineString",coordinates:r}}]};function o(l){var e=l.properties;return s=window._newMarker({lat:parseFloat(e.gate_lat),lng:parseFloat(e.gate_lon)},{icon:L.icon({iconUrl:`${n}/assets/images/leaflet/toll_gate.png`,iconSize:[30,30],iconAnchor:[16,25],popupAnchor:[0,-15]})},e.gate_name,`<h3 class="h6 text-center d-block text-uppercase font-weight-bold">INFO</h3><span class="bottom-line d-block mx-auto mt-3 mb-4"></span><div class="row my-2 mx-auto"><div class="col text-right border-right border-dark">GATE NAME</div><div class="col-7 pl-4">${e.gate_name}</div></div><div class="row my-2 mx-auto"><div class="col-5 text-right border-right border-dark">DATE TIME</div><div class="col-7 pl-4">${window.dtHumanParse(e.fddeclaration)}</div></div><div class="row my-2 mx-auto"><div class="col-5 text-right border-right border-dark">TOLL SECTION</div><div class="col-7 pl-4">${e.ftsection}</div></div><div class="row my-2 mx-auto"><div class="col-5 text-right border-right border-dark">DECLARATION</div><div class="col-7 pl-4">${e.ftdeclaration_type}</div></div><div class="row my-2 mx-auto"><div class="col-5 text-right border-right border-dark">PAYMENT TYPE</div><div class="col-7 pl-4">${e.ftpayment_type}</div></div>`).addTo(a),e.fddeclaration_exit&&(c=window._newMarker({lat:parseFloat(e.gate_exit_fflat),lng:parseFloat(e.gate_exit_fflon)},{icon:L.icon({iconUrl:`${n}/assets/images/leaflet/toll_gate.png`,iconSize:[30,30],iconAnchor:[16,25],popupAnchor:[0,-15]})},e.gate_name,`<h3 class="h6 text-center d-block text-uppercase font-weight-bold">INFO</h3><span class="bottom-line d-block mx-auto mt-3 mb-4"></span><div class="row my-2 mx-auto"><div class="col text-right border-right border-dark">GATE NAME</div><div class="col-7 pl-4">${e.gate_exit_name}</div></div><div class="row my-2 mx-auto"><div class="col-5 text-right border-right border-dark">DATE TIME</div><div class="col-7 pl-4">${window.dtHumanParse(e.fddeclaration_exit)}</div></div><div class="row my-2 mx-auto"><div class="col-5 text-right border-right border-dark">TOLL SECTION</div><div class="col-7 pl-4">${e.gate_exit_ftsection}</div></div><div class="row my-2 mx-auto"><div class="col-5 text-right border-right border-dark">DECLARATION</div><div class="col-7 pl-4">${e.ftdeclaration_exit}</div></div><div class="row my-2 mx-auto"><div class="col-5 text-right border-right border-dark">PAYMENT TYPE</div><div class="col-7 pl-4">${e.gate_exit_ftpayment_type}</div></div>`).addTo(a)),{pane:"pane_line_relay",opacity:1,color:"#FF0032",dashArray:"",lineCap:"square",lineJoin:"bevel",weight:1,fillOpacity:0,interactive:!0}}a.createPane("pane_line_relay"),a.getPane("pane_line_relay").style.zIndex=401,a.getPane("pane_line_relay").style["mix-blend-mode"]="normal",d=new L.geoJson(t,{attribution:"",interactive:!0,dataVar:"json_line_relay",layerName:"layer_line_relay",pane:"pane_line_relay",style:o}),m.addLayer(d),a.addLayer(d),a.fitBounds(m.getBounds())}
