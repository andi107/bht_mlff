import"./leaflet-svg-shape-markers-8f7f1e58.js";import"./leaflet.rotatedMarker-71d1d069.js";import"./_commonjsHelpers-28e086c5.js";const n=window.burl,v=$("input[name=_deviceid]").val();var c=$("#tblmlfflist").DataTable({lengthChange:!1,order:[[1,"desc"]],scrollX:!0,columnDefs:[{visible:!1,targets:[0]},{targets:-1,defaultContent:'<button class="btnview btn btn-pure btn-primary icon md-view waves-effect waves-classic">Log</button>'}]}),m=null;$("#tblmlfflist tbody").on("click","button.btnview",function(){var i=c.row($(this).parents("tr")).data();m=i[0],$("#modallog").modal("show")});$.get(n+`/tracking/detail/js/mlff/${v}`,function(i){$.each(i.mlffHistoryData.data,function(o,e){var r="-",l="-",t="-";e.fddeclaration_exit&&(r=window.dtHumanParse(e.fddeclaration_exit),l=e.gate_exit_name,t=e.gate_exit_ftsection),c.row.add([e.id,window.dtHumanParse(e.fddeclaration),e.gate_name,e.ftsection,r,l,t,e.declaration_status]).draw(!0)})});var a,d,s=new L.featureGroup([]);$("#modallog").on("shown.bs.modal",function(){if(!a){a=L.map("trackingmlff_log",{minZoom:5,fullscreenControl:!0,attributionControl:!1}).setView([.33995192349439596,120.3733680354565],5);var i=L.tileLayer(window.mapLayer);i.addTo(a)}$.get(n+`/tracking/detail/js/mlff/log/${m}`,function(o){var e=o.data.data;o.data.routes&&g(e,o.data.routes)})});$("#modallog").on("hidden.bs.modal",function(){a.removeLayer(d)});function g(i,o){var e={type:"FeatureCollection",name:"line_relay",features:[{type:"Feature",properties:i,geometry:{type:"LineString",coordinates:o}}]};function r(l){var t=l.properties;return window._newMarker({lat:parseFloat(t.gate_lat),lng:parseFloat(t.gate_lon)},{icon:L.icon({iconUrl:`${n}/assets/images/leaflet/toll_gate.png`,iconSize:[30,30],iconAnchor:[16,25],popupAnchor:[0,-15]})},t.gate_name,`<h3 class="h6 text-center d-block text-uppercase font-weight-bold">INFO</h3><span class="bottom-line d-block mx-auto mt-3 mb-4"></span><div class="row my-2 mx-auto"><div class="col text-right border-right border-dark">GATE NAME</div><div class="col-7 pl-4">${t.gate_name}</div></div><div class="row my-2 mx-auto"><div class="col-5 text-right border-right border-dark">DATE TIME</div><div class="col-7 pl-4">${window.dtHumanParse(t.fddeclaration)}</div></div><div class="row my-2 mx-auto"><div class="col-5 text-right border-right border-dark">TOLL SECTION</div><div class="col-7 pl-4">${t.ftsection}</div></div><div class="row my-2 mx-auto"><div class="col-5 text-right border-right border-dark">DECLARATION</div><div class="col-7 pl-4">${t.ftdeclaration_type}</div></div><div class="row my-2 mx-auto"><div class="col-5 text-right border-right border-dark">PAYMENT TYPE</div><div class="col-7 pl-4">${t.ftpayment_type}</div></div>`).addTo(a),t.fddeclaration_exit&&window._newMarker({lat:parseFloat(t.gate_exit_fflat),lng:parseFloat(t.gate_exit_fflon)},{icon:L.icon({iconUrl:`${n}/assets/images/leaflet/toll_gate.png`,iconSize:[30,30],iconAnchor:[16,25],popupAnchor:[0,-15]})},t.gate_name,`<h3 class="h6 text-center d-block text-uppercase font-weight-bold">INFO</h3><span class="bottom-line d-block mx-auto mt-3 mb-4"></span><div class="row my-2 mx-auto"><div class="col text-right border-right border-dark">GATE NAME</div><div class="col-7 pl-4">${t.gate_exit_name}</div></div><div class="row my-2 mx-auto"><div class="col-5 text-right border-right border-dark">DATE TIME</div><div class="col-7 pl-4">${window.dtHumanParse(t.fddeclaration_exit)}</div></div><div class="row my-2 mx-auto"><div class="col-5 text-right border-right border-dark">TOLL SECTION</div><div class="col-7 pl-4">${t.gate_exit_ftsection}</div></div><div class="row my-2 mx-auto"><div class="col-5 text-right border-right border-dark">DECLARATION</div><div class="col-7 pl-4">${t.ftdeclaration_exit}</div></div><div class="row my-2 mx-auto"><div class="col-5 text-right border-right border-dark">PAYMENT TYPE</div><div class="col-7 pl-4">${t.gate_exit_ftpayment_type}</div></div>`).addTo(a),{pane:"pane_line_relay",opacity:1,color:"#FF0032",dashArray:"",lineCap:"square",lineJoin:"bevel",weight:1,fillOpacity:0,interactive:!0}}a.createPane("pane_line_relay"),a.getPane("pane_line_relay").style.zIndex=401,a.getPane("pane_line_relay").style["mix-blend-mode"]="normal",d=new L.geoJson(e,{attribution:"",interactive:!0,dataVar:"json_line_relay",layerName:"layer_line_relay",pane:"pane_line_relay",style:r}),s.addLayer(d),a.addLayer(d),a.fitBounds(s.getBounds())}
